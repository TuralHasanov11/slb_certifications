LiscencesPage As screen:
    Fill: =
    OnVisible: |-
        =Set(AuthUserEmail, User().Email);
        Set(AuthUser, First(Filter(Users,User().Email=User.Email)));
        Set(currentPage, {page: "CertificatesPage"})

    AppLayout_2 As AppLayout:
        PageTitle: ="Certificates"

    CertificateList As gallery.galleryVertical:
        BorderThickness: =0.05
        Height: =483
        Items: =SortByColumns(Filter([@Certificates], StartsWith(Title, CertificateFilter.Text), "Admins" in AuthUser.Group.Value Or Department.Value in AuthUser.Group.Value), SortByDropdown.Selected.value, If(SortDescending1, Descending, Ascending))
        Layout: =Layout.Vertical
        OnSelect: =Navigate(LiscenceDetailPage, ScreenTransition.Fade)
        TemplateSize: =78
        Width: =1023
        X: =260
        Y: =268
        ZIndex: =2

        CertificateTitle As label:
            OnSelect: =Select(Parent)
            Text: =ThisItem.Title
            Y: =15
            ZIndex: =1

        CertificateExpirationDate As label:
            OnSelect: =Select(Parent)
            Text: =Text(ThisItem.ExpirationDate, "d.mm.yyyy")
            X: =162
            Y: =15
            ZIndex: =2

        CertificateDepartment As label:
            OnSelect: =Select(Parent)
            Text: =ThisItem.Department.Value
            Width: =143
            X: =364
            Y: =15
            ZIndex: =3

        CertificateIssueDate As label:
            OnSelect: =Select(Parent)
            Text: =Text(ThisItem.IssueDate, "d.mm.yyyy")
            X: =559
            Y: =15
            ZIndex: =5

        CertificateEdit As icon.Edit:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 191, 0, 1)
            Height: =40
            Icon: =Icon.Edit
            OnSelect: =ResetForm(CertificateForm);EditForm(CertificateForm); Navigate(AddLiscencePage, ScreenTransition.Fade)
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            Width: =40
            X: =904
            Y: =15
            ZIndex: =9

        CertificateDelete As icon.Trash:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(230, 41, 41, 1)
            Height: =40
            Icon: =Icon.Trash
            OnSelect: =Remove([@Certificates], CertificateList.Selected); If (IsEmpty(Errors([@Certificates], CertificateList.Selected)), Back())
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            Width: =40
            X: =956
            Y: =15
            ZIndex: =10

        CertficateDetail As icon.DocumentwithContent:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 51, 102, 1)
            Height: =40
            Icon: =Icon.DocumentWithContent
            OnSelect: =Navigate(LiscenceDetailPage, ScreenTransition.Fade)
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            Width: =40
            X: =852
            Y: =15
            ZIndex: =11

        Label6 As label:
            Color: =If(ThisItem.ExpirationDate>Now(), RGBA(54, 176, 75, 1), RGBA(246, 45, 16, 1)) 
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            Text: =If(ThisItem.ExpirationDate>Now(),"Active","Expired")
            Width: =121
            X: =731
            Y: =15
            ZIndex: =12

    CertificateFilter As text:
        Default: =""
        HintText: ="Search"
        X: =260
        Y: =172
        ZIndex: =4

    Rectangle4_1 As rectangle:
        Height: =40
        Width: =1023
        X: =260
        Y: =228
        ZIndex: =7

    THOperations_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Department"
        X: =618
        Y: =228
        ZIndex: =8

    THGroups_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Expiration Date"
        Width: =164
        X: =416
        Y: =228
        ZIndex: =9

    THEmail_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Title"
        Width: =156
        X: =260
        Y: =228
        ZIndex: =11

    THOperations_2 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Issue Date"
        Width: =183
        X: =807
        Y: =228
        ZIndex: =12

    Group4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =12

        Button2_1 As button:
            BorderThickness: =0
            Fill: =RGBA(92, 184, 92, 1)
            Height: =46
            OnSelect: =NewForm(CertificateForm);Navigate(AddLiscencePage, ScreenTransition.Fade)
            Text: ="Add Liscence"
            Width: =225
            X: =1058
            Y: =169
            ZIndex: =5

        Icon1_1 As icon.Add:
            Color: =RGBA(255, 255, 255, 1)
            Height: =24
            Icon: =Icon.Add
            Width: =24
            X: =1072
            Y: =180
            ZIndex: =6

    THOperations_3 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Operations"
        Width: =188
        X: =1095
        Y: =228
        ZIndex: =13

    SortByDropdown As dropdown:
        Items: |-
            =Table({value:"Title"},{value:"IssueDate"}, {value:"ExpirationDate"})
        Width: =305
        X: =607
        Y: =172
        ZIndex: =14

    Icon2 As icon.ArrowsUpDown:
        Height: =36
        Icon: =Icon.Sort
        OnSelect: |-
            =UpdateContext({SortDescending1: !SortDescending1})
        Width: =52
        X: =912
        Y: =172
        ZIndex: =15

    THOperations_4 As label:
        Color: =RGBA(255, 255, 255, 1)
        Size: =16
        Text: ="Status"
        Width: =89
        X: =990
        Y: =228
        ZIndex: =16

    Label8 As label:
        Height: =38
        Text: =
        Width: =255
        X: =363
        Y: =99
        ZIndex: =17

